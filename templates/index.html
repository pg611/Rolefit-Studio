<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RoleFit Studio — Resume ↔ JD Analyzer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg: #0b1220;
      --fg: #e7eaef;
      --muted:#a7b0c0;
      --card:#121a2b;
      --accent:#6ea8fe;
      --accent-2:#9b8cff;
      --border:#263149;
      --chip:#1b2540;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 14px;
    }
    *{ box-sizing: border-box; }
    body{
      margin:0; background: radial-gradient(1200px 700px at 15% -5%, #18223a 0, #0c1322 60%, #0b1120 100%), var(--bg);
      color:var(--fg); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height:1.5; padding-bottom:60px;
    }
    header{
      padding:32px 20px 18px;
      background: linear-gradient(120deg, rgba(110,168,254,.2), rgba(155,140,255,.18) 40%, rgba(110,168,254,.15) 90%);
      border-bottom:1px solid var(--border);
    }
    .wrap{ max-width: 1040px; margin: 0 auto; padding: 0 20px; }
    h1{ margin:0 0 6px; font-weight:750; letter-spacing:.2px; }
    .tagline{ color:var(--muted); margin-top:4px; }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
      margin:18px 0;
    }
    label{ font-weight:600; display:block; margin-bottom:8px; }
    input[type="file"], textarea{
      width:100%; border:1px solid var(--border); background:#0e1730; color:var(--fg);
      border-radius:12px; padding:12px; outline:none;
    }
    textarea{ min-height:180px; resize:vertical; }
    .btn{
      padding:12px 18px; border:none; border-radius:12px; cursor:pointer; color:#0a0f1f; font-weight:700;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      transition: transform .05s ease;
    }
    .btn:hover{ transform: translateY(-1px); }

    .score-banner{
      display:flex; align-items:center; gap:16px; margin-top:4px;
    }
    .score-circle{
      width:92px; height:92px; border-radius:50%;
      background: conic-gradient(var(--accent), var(--accent-2));
      display:grid; place-items:center; color:#0b1120; font-size:20px; font-weight:900;
      box-shadow: 0 6px 22px rgba(110,168,254,.28);
    }
    .score-circle > span{
      background:#fff; color:#0b1120; padding:10px 12px; border-radius:50%;
      min-width:72px; text-align:center; font-variant-numeric: tabular-nums;
    }
    .muted{ color:var(--muted); }

    /* Tabs */
    .tabs{ margin-top:10px; }
    .tabbar{
      display:flex; gap:8px; border-bottom:1px solid var(--border);
      padding:0 6px; overflow:auto; scrollbar-width:none;
    }
    .tabbar::-webkit-scrollbar{ display:none; }
    .tabbtn{
      appearance:none; background:none; border:none; color:var(--muted); padding:12px 10px; font-weight:700; cursor:pointer;
      border-bottom:2px solid transparent; transition:color .15s ease, border-color .15s ease;
    }
    .tabbtn.active{ color:var(--fg); border-color:var(--accent); }
    .tabpanes{ padding:14px 6px; }
    .pane{ display:none; }
    .pane.active{ display:block; }

    /* Evidence list */
    ol{ margin: 10px 0 0 20px; }
    .snippet{
      white-space: pre-wrap; background:var(--chip); border:1px solid var(--border); border-radius:12px; padding:12px; margin-top:8px;
    }
    .chip{
      display:inline-block; padding:4px 10px; border-radius:999px; background:#122046; border:1px solid var(--border);
      color:#cfe0ff; font-weight:700; font-size:12px; margin-right:8px;
    }
    details{
      background:#0f1831; border:1px solid var(--border); border-radius:12px; padding:10px 12px; margin-top:10px;
    }
    summary{ cursor:pointer; font-weight:700; }
    ul{ margin:8px 0 0 18px; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>RoleFit Studio</h1>
      <div class="tagline">ATS-friendly analyzer to see how well your resume aligns with a job description.</div>
    </div>
  </header>

  <main class="wrap">
    <form class="card" method="POST" enctype="multipart/form-data">
      <div style="display:grid; gap:16px;">
        <div>
          <label for="resume">Resume (PDF or DOCX)</label>
          <input type="file" id="resume" name="resume" accept=".pdf,.docx" required />
        </div>
        <div>
          <label for="job_description">Job Description (paste full text)</label>
          <textarea id="job_description" name="job_description" placeholder="Paste the full JD here..." required></textarea>
        </div>
        <div>
          <button class="btn" type="submit">Analyze Fit</button>
        </div>
      </div>
    </form>

    {% if analysis_results %}
      <section class="card">
        <h2 style="margin-top:0;">Overall Role Fit</h2>
        <div class="score-banner">
          <div class="score-circle"><span>{{ analysis_results.overall_score|round(1) }}%</span></div>
          <div class="muted">
            Your resume’s overall semantic alignment to this JD (higher is better).<br>
            Tip: strengthen domain terms and tools mentioned in the JD to raise this score.
          </div>
        </div>

        <div class="tabs">
          <div class="tabbar">
            <button class="tabbtn active" data-tab="t1">Highlights (Best-Matching Sections)</button>
            <button class="tabbtn" data-tab="t2">Missing Terms</button>
            <button class="tabbtn" data-tab="t3">Matched Terms</button>
            <button class="tabbtn" data-tab="t4">Extracted Resume</button>
          </div>

          <div class="tabpanes">
            <!-- t1: Highlights -->
            <div id="t1" class="pane active">
              <p class="muted">Top sections of your resume that best support the JD.</p>
              <ol>
                {% for m in analysis_results.top_matches %}
                  <li>
                    <span class="chip">{{ (m.score * 100) | round(1) }}% fit</span>
                    <div class="snippet">{{ m.text }}</div>
                  </li>
                {% endfor %}
              </ol>
            </div>

            <!-- t2: Missing Terms -->
            {% if coverage_results %}
            <div id="t2" class="pane">
              <p class="muted">Terms/phrases from the JD not found in your resume (exact text). Add naturally—avoid stuffing.</p>
              <details open>
                <summary>Missing Terms</summary>
                <ul>
                  {% for t in coverage_results.missing %}
                    <li>{{ t }}</li>
                  {% endfor %}
                </ul>
              </details>
            </div>
            {% endif %}

            <!-- t3: Matched Terms -->
            {% if coverage_results %}
            <div id="t3" class="pane">
              <p class="muted">Terms/phrases from the JD already present in your resume.</p>
              <details open>
                <summary>Matched Terms</summary>
                <ul>
                  {% for t in coverage_results.matched %}
                    <li>{{ t }}</li>
                  {% endfor %}
                </ul>
              </details>
            </div>
            {% endif %}

            <!-- t4: Extracted Resume -->
            {% if extracted_text %}
            <div id="t4" class="pane">
              <p class="muted">Raw text we extracted from your uploaded resume (for transparency/troubleshooting).</p>
              <details open>
                <summary>Show/Hide Resume Text</summary>
                <div class="snippet">{{ extracted_text }}</div>
              </details>
            </div>
            {% endif %}
          </div>
        </div>
      </section>
    {% endif %}
  </main>

  <script>
    // simple tab controller
    const btns = document.querySelectorAll('.tabbtn');
    const panes = document.querySelectorAll('.pane');
    btns.forEach(b=>{
      b.addEventListener('click', ()=>{
        btns.forEach(x=>x.classList.remove('active'));
        panes.forEach(p=>p.classList.remove('active'));
        b.classList.add('active');
        const id = b.dataset.tab;
        document.getElementById(id).classList.add('active');
      });
    });
  </script>
</body>
</html>

